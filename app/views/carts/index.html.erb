<h1>购物车</h1>

<%= link_to("清空购物车", clean_carts_path, method: :delete, class:"btn btn-danger pull-right", data: { confirm: "你确定要清空购物车吗？"})%>

<div class="col-md-12">
  <table class="table table-bordered">
    <thead>
      <tr>
        <th colspan="2">商品资讯</th>
        <th>单价</th>
        <th>数量</th>
        <th>操作选项</th>
      </tr>
    </thead>
    <tbody>
      <% current_cart.cart_items.each do |cart_item| %>
      <tr>
        <td>
          <% if cart_item.product.image.present? %>
          <%= image_tag(cart_item.product.image.thumb.url, class:"thumbnail")%>
        <% else %>
          <%= image_tag("http://placehold.it/200x200&text=No Pic", class:"thumbnail" )%>
          <% end %>
        </td>
        <td><%= cart_item.product.title%></td>
        <td><%= cart_item.product.price %></td>
        <td>
          <%= form_for cart_item, url: cart_item_path(cart_item.product_id) do |f|%>
          <%= f.select :quantity, 1..cart_item.product.quantity%>
          <%= f.submit "Submit", data:{disable_with: "submiting..."}%>
          <% end %>
        </td>
        <td><%= link_to(content_tag(:i,"", class: "fa fa-trash"), cart_item_path(cart_item),method: :delete, data:{confirm: "确定吗？"})%></td>
      </tr>
      <% end %>
    </tbody>
  </table>
  <div class="total clearfix group">
    <span class="pull-right">
      总计
      <%= render_cart_total_price(current_cart) %>
      RMB
    </span>
  </div>
  <hr/>
  <%= link_to("确认结账", checkout_carts_path,method: :post, class:"btn btn-lg btn-danger pull-right")%>
</div>
